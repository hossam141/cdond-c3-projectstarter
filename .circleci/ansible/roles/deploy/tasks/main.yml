---
  - name: "Creates backend app directory"
    file:
      path: ~/backend-app
      state: directory
      mode: 0755
      
  - name: "Unarchive backend files"
    unarchive:
      src: artifact.tar.gz
      dest: ~/backend-app
      mode: 0755
      owner: ubuntu
      group: ubuntu

  - name: "Installing dependencies"
    shell: |
      cd ~/backend-app
      curl -fsSL https://deb.nodesource.com/setup_13.x | sudo -E bash -
      sudo apt install -y nodejs
      sudo npm install -g npm@latest
      sudo npm install -g webpack-dev-server
      sudo npm install
      sudo npm run build
      sudo pm2 start npm --name backend -- start
